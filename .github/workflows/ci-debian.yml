# Copyright (C) 2023, RTE (http://www.rte-france.com)
# SPDX-License-Identifier: Apache-2.0

name: CI debian

env:
  CI_DIR: /tmp/seapath_ci_${{ github.run_id }}_${{ github.run_attempt }}

on:
  push:
  pull_request:
    types: [opened, reopened, edited, review_requested]
    branches: [debian-main]

jobs:
  ci:
    runs-on: self-hosted
    steps:
    
      - name: Configure Sources
        run: mkdir ${{ env.CI_DIR }}; cd ${{ env.CI_DIR }};
             git clone -q --depth 1 -b main https://github.com/eroussy/ci-seapath ci;
             echo "CI sources downloaded successfully";
             ci/launch.sh config;
        
            
      - name: Setup Debian
        run: cd ${{ env.CI_DIR }}
             ci/launch.sh setup
             
      - name: Launch test
        run: cd ${{ env.CI_DIR }}
             $CI_DIR/ci/launch.sh test
